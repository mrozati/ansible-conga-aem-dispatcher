# wcm-io-devops.conga_aem_dispatcher

This role deploys the configuration artifacts generated by the CONGA
role
[aem-dispatcher](https://github.com/wcm-io-devops/conga-aem-definitions/blob/develop/conga-aem-definitions/src/main/roles/aem-dispatcher.yaml)
with Ansible. It also configured the webserver based on the CONGA
configuration model.

It is part of the wcm.io set of roles to integrate Ansible with
[CONGA](http://devops.wcm.io/conga/) and cannot be used independently.

## Requirements

This role requires Ansible 2.0 or higher.

## Role Variables

This role currently has no variables since it totally relies on the
CONGA configuration model.

## Dependencies

* [wcm-io-devops.conga_facts](https://github.com/wcm-io-devops/ansible-conga-facts)
  role for accessing the CONGA configuration model.

## Example

Compiles the CONGA configuration, installs the webserver with the
Ansible [wcm-io-devops.apache](https://github.com/wcm-io-devops/ansible-role-apache) role and deploys the configuration from
the CONGA `aem-dispatcher` role in the `aem-author` variant.

	- hosts: localhost
	  roles:
	    - wcm-io-devops.conga_maven
	
	- hosts: webserver
	  pre_tasks:
	    # Setup CONGA facts for the role aem-dispatcher so that
        # we have access to the httpd port configuration
        - conga_facts:
            conga_role_mapping: aem-dispatcher
    
        - set_fact:
            # Save http and https port config aem-dispacher role for use by the aem-dispatcher role
            aem_dispatcher_port: "{{ conga_config.httpd.serverPort | default(80) }}"
            aem_dispatcher_port_ssl: "{{ conga_config.httpd.serverPortSsl | default(443) }}"
	  roles:
	    - wcm-io-devops.aem_dispatcher
        - { role: wcm-io-devops.conga_aem_dispatcher,
            conga_variant_mapping: aem-author
          }

## License

Apache 2.0
